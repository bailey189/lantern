{% extends "base.html" %}
{% block content %}

<div class="container mt-4">
    <h2>Advanced Network & Security Scanning</h2>
    <form method="POST" action="{{ url_for('main.scan') }}">
        <!-- Section: Network Scanning & Enumeration -->
        <h4 class="mt-4">Network Scanning & Enumeration</h4>

        <div class="form-check">
            <input class="form-check-input" type="checkbox" name="tools" value="nmap" id="nmapCheck">
            <label class="form-check-label" for="nmapCheck">Nmap</label>
        </div>
        <div class="mb-3">
            <input type="text" class="form-control" name="nmap_target" placeholder="Target IP (e.g., 192.168.1.0/24)">
        </div>

        <div class="form-check">
            <input class="form-check-input" type="checkbox" name="tools" value="masscan" id="masscanCheck">
            <label class="form-check-label" for="masscanCheck">Masscan</label>
        </div>
        <div class="mb-3">
            <input type="text" class="form-control" name="masscan_target" placeholder="Target IP and port (e.g., 192.168.1.0/24:80)">
        </div>

        <div class="form-check">
            <input class="form-check-input" type="checkbox" name="tools" value="angryip" id="angryipCheck">
            <label class="form-check-label" for="angryipCheck">AngryIPScanner</label>
        </div>
        <div class="mb-3">
            <input type="text" class="form-control" name="angryip_range" placeholder="IP Range (e.g., 192.168.1.1-254)">
        </div>

        <div class="form-check">
            <input class="form-check-input" type="checkbox" name="tools" value="arpscan" id="arpscanCheck">
            <label class="form-check-label" for="arpscanCheck">Arp-scan</label>
        </div>
        <div class="mb-3">
            <input type="text" class="form-control" name="arpscan_interface" placeholder="Network Interface (e.g., eth0)">
        </div>

        <div class="form-check">
            <input class="form-check-input" type="checkbox" name="tools" value="dhcpdump" id="dhcpdumpCheck">
            <label class="form-check-label" for="dhcpdumpCheck">Dhcpdump</label>
        </div>

        <!-- Section: Wireless & Packet Analysis -->
        <h4 class="mt-4">Wireless & Packet Analysis</h4>

        <div class="form-check">
            <input class="form-check-input" type="checkbox" name="tools" value="kismet" id="kismetCheck">
            <label class="form-check-label" for="kismetCheck">Kismet</label>
        </div>

        <div class="form-check">
            <input class="form-check-input" type="checkbox" name="tools" value="aircrack" id="aircrackCheck">
            <label class="form-check-label" for="aircrackCheck">Aircrack-ng</label>
        </div>

        <div class="form-check">
            <input class="form-check-input" type="checkbox" name="tools" value="hping3" id="hping3Check">
            <label class="form-check-label" for="hping3Check">Hping3</label>
        </div>
        <div class="mb-3">
            <input type="text" class="form-control" name="hping3_target" placeholder="Target IP (e.g., 192.168.1.1)">
        </div>

        <!-- Section: Web & Application Security -->
        <h4 class="mt-4">Web & Application Security</h4>

        <div class="form-check">
            <input class="form-check-input" type="checkbox" name="tools" value="nikto" id="niktoCheck">
            <label class="form-check-label" for="niktoCheck">Nikto</label>
        </div>
        <div class="mb-3">
            <input type="text" class="form-control" name="nikto_url" placeholder="Target URL (e.g., http://192.168.1.10)">
        </div>

        <div class="form-check">
            <input class="form-check-input" type="checkbox" name="tools" value="wapiti" id="wapitiCheck">
            <label class="form-check-label" for="wapitiCheck">Wapiti</label>
        </div>
        <div class="mb-3">
            <input type="text" class="form-control" name="wapiti_url" placeholder="Target URL (e.g., http://example.com)">
        </div>

        <div class="form-check">
            <input class="form-check-input" type="checkbox" name="tools" value="skipfish" id="skipfishCheck">
            <label class="form-check-label" for="skipfishCheck">Skipfish</label>
        </div>
        <div class="mb-3">
            <input type="text" class="form-control" name="skipfish_url" placeholder="Target URL (e.g., http://host)">
        </div>

        <div class="form-check">
            <input class="form-check-input" type="checkbox" name="tools" value="sqlmap" id="sqlmapCheck">
            <label class="form-check-label" for="sqlmapCheck">SQLmap</label>
        </div>
        <div class="mb-3">
            <input type="text" class="form-control" name="sqlmap_url" placeholder="Target URL or POST data">
        </div>

        <!-- Section: System & Compliance Scanning -->
        <h4 class="mt-4">System & Compliance Scanning</h4>

        <div class="form-check">
            <input class="form-check-input" type="checkbox" name="tools" value="trivy" id="trivyCheck">
            <label class="form-check-label" for="trivyCheck">Trivy</label>
        </div>
        <div class="mb-3">
            <input type="text" class="form-control" name="trivy_image" placeholder="Container Image (e.g., nginx:latest)">
        </div>

        <div class="form-check">
            <input class="form-check-input" type="checkbox" name="tools" value="ansible" id="ansibleCheck">
            <label class="form-check-label" for="ansibleCheck">Ansible</label>
        </div>

        <!-- Submit Button -->
        <div class="mt-4">
            <button type="submit" class="btn btn-primary">Run Selected Scans</button>
        </div>
    </form>

    <!-- Display Results -->
    {% if result %}
    <div class="card mt-5">
        <div class="card-header">Scan Output</div>
        <div class="card-body">
            <pre>{{ result }}</pre>
        </div>
    </div>
    {% endif %}
</div>

{% endblock %}
